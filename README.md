# Tanoshi Game

A fun browser-based game built with the T3 stack (Next.js, tRPC, Drizzle ORM, PostgreSQL, Tailwind CSS).

## Game Concept

The player controls a hamster located at the bottom of the screen. Food items fall from the sky, and the player must move the hamster left and right to catch and eat the food. The player must avoid falling jalapeños, which reduce health or end the game.

## Features

- **Start screen** with a "Play" button
- **Game canvas** where the hamster moves and items fall
- **Keyboard controls**: left/right arrow keys (or A/D) to move the hamster
- **Score tracking**: +1 for each food caught
- **Health system**: Lose one life if the hamster touches a jalapeño
- **Game over screen** with final score and restart button
- **Leaderboard** showing top scores from the database

## Tech Stack

- **Frontend**: Next.js, React, Tailwind CSS
- **Backend**: tRPC, Drizzle ORM, PostgreSQL
- **Assets**: UploadThing for image hosting

## How to Play

1. Click "Start Game" on the main screen
2. Use the left/right arrow keys or A/D keys to move the hamster
3. Catch falling food items to increase your score
4. Avoid jalapeños to preserve your health
5. The game ends when you lose all lives
6. Submit your score to the leaderboard

## Development

### Prerequisites

- Node.js
- PostgreSQL database
- UploadThing account (for asset hosting)

### Setup

1. Clone the repository
2. Install dependencies:
   ```bash
   pnpm install
   ```
3. Set up environment variables (see `.env.example`)
4. Run database migrations:
   ```bash
   pnpm run db:generate
   pnpm run db:migrate
   ```
5. Start the development server:
   ```bash
   pnpm run dev
   ```

### Available Scripts

- `pnpm run dev` - Start development server
- `pnpm run build` - Build for production
- `pnpm run check` - Run linting and type checking
- `pnpm run db:generate` - Generate database migrations
- `pnpm run db:migrate` - Apply database migrations
- `pnpm run db:studio` - Open Drizzle Studio

## Project Structure

```
src/
├── app/                 # Next.js app router
│   ├── _components/     # React components
│   ├── api/             # API routes
│   ├── leaderboard/     # Leaderboard page
│   ├── layout.tsx       # Root layout
│   └── page.tsx         # Main game page
├── server/              # Server-side code
│   ├── api/             # tRPC routers
│   └── db/              # Database schema
└── trpc/                # tRPC configuration
```

## Game Components

- `Game.tsx` - Main game component with state management
- `Hamster.tsx` - Hamster character component (uses UploadThing image)
- `Food.tsx` - Food and jalapeño components (use UploadThing images)
- `Leaderboard.tsx` - Leaderboard display component
- `LeaderboardPage.tsx` - Dedicated leaderboard page

## Assets

The game uses UploadThing for hosting assets:
- Hamster character image
- Food item images
- Jalapeño images

To use your own images:
1. Upload your images to UploadThing
2. Replace the placeholder URLs in `Hamster.tsx` and `Food.tsx`
3. Update the image dimensions as needed

## Database Schema

The game uses a PostgreSQL database with a `scores` table:

```sql
CREATE TABLE "tanoshigame_score" (
  "id" integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  "playerName" varchar(256),
  "score" integer NOT NULL,
  "createdAt" timestamp with time zone DEFAULT CURRENT_TIMESTAMP NOT NULL
);
```

## API Endpoints

### tRPC Procedures

- `score.submit` - Submit a new score
- `score.top` - Fetch top scores

## Future Improvements

- Add sound effects
- Implement power-ups
- Add different difficulty levels
- Improve graphics with actual UploadThing assets
- Add mobile touch controls
- Implement animations and visual effects